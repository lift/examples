<!DOCTYPE html>
<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type" />
    <title>Template</title>
</head>

<body data-lift-content-id="main">
    <div id="main" data-lift="surround?with=default;at=content">

        <!-- The AutoComplete function (widgets.autocomplete) used by Ajax.scala uses a
    really old jqurey so we need to add jquery migrate for that functionality to work. -->
        <head_merge>
            <script id="jquery-migrate" src="/classpath/fobo/jquery-migrate.js" type="text/javascript"></script>
        </head_merge>
        <h2><span data-lift="Menu.title">%*%</span></h2>

        <span data-lift="FoBo.Bs4Comp.breadCrumb?prefix=Home"></span>

        <div id="wrappedNoticeAtHead">
            <div data-lift="Msgs"></div>
        </div>

        <div data-lift="Ajax.sample?id_name=cnt_id;id_msgs=messages">
            <div id="ajaxClicker">
                <span>Click me to increase the count (currently
                    <span id='cnt_id'>0</span>)</span>
            </div>

            <br>

            <div id="messages"></div>
            <!--<div id="bcmessages"></div>-->

            <div class="form-group row">
                <div class="col-sm-2">
                    <div id="ajaxSelect">
                        You selected '
                        <span id="selNumber"></span>' from the select box.
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-6">
                    <div id="ajaxText">
                        You entered '
                        <span id="textValue"></span>' in the text box.
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-12 col-form-label" for="ajaxAuto">An example of autocomplete with a server round
                    trip to calculate the autocomplete list</label>
                <div class="col-sm-6">
                    <div id="ajaxAuto"></div>
                </div>
            </div>
        </div>

        <p>
            Each time an Ajax or Comet update is made to the page, we update this span:
            <span id="timely" data-lift="Timely">The time is</span>
        </p>

        <div id="bcmessages"></div>

        <div class="form-group row">
            <label for="the_input" class="col-sm-4 col-form-label">Enter some text:</label>
            <div class="col-sm-8">
                <input id="the_input" class="form-control">
            </div>
        </div>
        <div class="form-group row">
            <div class="col-sm-12">
                <button class="btn btn-primary" data-lift="Ajax.buttonClick">Click Here</button>
            </div>
        </div>

        <br>

        <span class="badge badge-secondary">The
            <i>Lift</i> Scala code</span>
        <pre><code class="scala">class Ajax extends Loggable {

  def sample(xhtml: NodeSeq): NodeSeq = {
    // local state for the counter
    var cnt = 0

    // get the id of some elements to update
    val spanName: String = S.attr("id_name") openOr "cnt_id"
    val msgName: String = S.attr("id_msgs") openOr "messages"

    // build up an ajax &lt;a&gt; tag to increment the counter
    def doClicker(text: NodeSeq) =
      a(() => { cnt = cnt + 1; SetHtml(spanName, Text(cnt.toString)) }, text)

    // create an ajax select box
    def doSelect(msg: NodeSeq) =
      ajaxSelect(
        (1 to 50).toList.map(i => (i.toString, i.toString)),
        Full(1.toString),
        v => {
          val selectBind = "#selNumber" #> Text(v)
          DisplayMessage(
            msgName,
            &lt;span&gt;{selectBind(msg)}&lt;/span&gt;,
            5 seconds,
            1 second
          )
        },
        "class" -> "form-control"
      )

    // build up an ajax text box
    def doText(msg: NodeSeq) =
      ajaxText(
        "",
        v => {
          val textBind = "#textValue" #> Text(v)
          DisplayMessage(msgName,
                         &lt;span&gt;{textBind(msg)}&lt;/span&gt;,
                         6 seconds,
                         1 second)
        },
        "class" -> "form-control"
      )

    // bind the view to the functionality
    val viewBind = {
      "#ajaxClicker" #> doClicker _ &
        "#ajaxSelect" #> doSelect _ &
        "#ajaxText" #> doText _ &
        "#ajaxAuto" #> AutoComplete("",
                                    buildQuery _,
                                    (x: String) => (),
                                    "class" -> "form-control")
    }
    viewBind(xhtml)
  }

  private def buildQuery(current: String, limit: Int): Seq[String] = {
    logger.info("Checking on server side with " + current + " limit " + limit)
    (1 to limit).map(n => current + "" + n)
  }

  def time = Text(now.toString)

  def buttonClick = {
    import js.JE._

    "* [onclick]" #> SHtml.ajaxCall(
      ValById("the_input"),
      s =>
        SetHtml("bcmessages",
                &lt;i&gt;Latest Button click was with text box value '{s}'&lt;/i&gt;))
  }
}</code></pre>

    </div>
</body>

</html>