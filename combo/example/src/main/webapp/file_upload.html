<!DOCTYPE html>
<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type" />
    <title>Template</title>
</head>

<body data-lift-content-id="main">
    <div id="main" data-lift="surround?with=default;at=content">
        <h2><span data-lift="Menu.title">%*%</span></h2>

        <span data-lift="FoBo.Bs4Comp.breadCrumb?prefix=Home"></span>

        <p>
            This is the file upload sample page. You choose a file to upload and the application will tell you the file
            name, the mime
            type, the number of bytes in the file and the MD5 checksum.
        </p>

        <form data-lift="misc.upload?form=post&multipart=true">
            <span id="choose">
                <span id="post">
                    <p>
                        File name: <span class="file_name"></span><br>
                        MIME Type: <span class="mime_type"></span><br>
                        File length: <span class="length"></span><br>
                        MD5 Hash: <span class="md5"></span><br>
                    </p>
                </span>

                <span id="get">
                    <div class="form-group row">
                        <div class="col-md-8">
                            <div class="custom-file">
                                <input type="file" class="custom-file-input" id="customFile">
                                <label class="custom-file-label" for="customFile">Select a file to upload</label>
                            </div>
                        </div>
                    </div>
                    <input type="submit" value="Upload File" class="btn btn btn-primary">
                </span>
            </span>
        </form>

        <br>
        <span class="badge badge-secondary">The Markup</span>
        <pre><code>&lt;form data-lift="misc.upload?form=post&multipart=true"&gt;
    &lt;span id="choose"&gt;
        &lt;span id="post"&gt;
        &lt;p&gt;
            File name: &lt;span class="file_name"&gt;&lt;/span&gt;&lt;br&gt;
            MIME Type: &lt;span class="mime_type"&gt;&lt;/span&gt;&lt;br&gt;
            File length: &lt;span class="length"&gt;&lt;/span&gt;&lt;br&gt;
            MD5 Hash: &lt;span class="md5"&gt;&lt;/span&gt;&lt;br&gt;
        &lt;/p&gt;
        &lt;/span&gt;

        &lt;span id="get"&gt;
        &lt;div class="form-group row"&gt;
          &lt;div class="col-md-8"&gt;
             &lt;div class="custom-file"&gt;
               &lt;input type="file" class="custom-file-input" id="customFile"&gt;
               &lt;label class="custom-file-label" for="customFile"&gt;Select a file to upload&lt;/label&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;input type="submit" value="Upload File" class="btn btn btn-primary"&gt;
        &lt;/span&gt;

    &lt;/span&gt;
&lt;/form&gt;</code></pre>

        <span class="badge badge-secondary">The
            <i>Lift</i> Scala code</span>
        <pre><code class="scala">// the request-local variable that hold the file parameter
private object theUpload extends RequestVar[Box[FileParamHolder]](Empty)

def upload(xhtml: Group): NodeSeq =
if (S.get_?)
  (
    "#get ^*" #> "#choose" &
      ".custom-file-input" #> fileUpload(ul => theUpload(Full(ul)))
  ) apply (xhtml)
else
  ("#post ^*" #> "#choose" &
    ".file_name" #> theUpload.is.map(v => Text(v.fileName)) &
    ".mime_type" #> theUpload.is.map(
      v =>
        Box
          .legacyNullTest(v.mimeType)
          .map(Text.apply)
          .openOr(Text("No mime type supplied"))) &
    ".length" #> theUpload.is.map(v => Text(v.file.length.toString)) &
    ".md5" #> theUpload.is.map(v => Text(hexEncode(md5(v.file))))) apply (xhtml)</code></pre>

    </div>
</body>

</html>