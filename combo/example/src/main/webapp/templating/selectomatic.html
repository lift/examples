<!DOCTYPE html>
<html>

<head>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type" />
  <title>Template</title>
</head>

<body data-lift-content-id="main">
  <div id="main" data-lift="surround?with=default;at=content">
    <h2><span data-lift="Menu.title">%*%</span></h2>

    <span data-lift="FoBo.Bs4Comp.breadCrumb?prefix=Home"></span>

    <div id="wrappedNoticeAtHead">
      <div data-lift="Msgs"></div>
    </div>

    <p>
      On this page, we'll allow the user to select a series of &lt;div&gt; tags to display based on the results of a form submission.
    </p>

    <div>
      <form data-lift="DivSelector.populate?form=post">
        <div id="line">
          &lt;div&gt; number <span id="number"></span> visible
          <span id="checkbox"></span>
          <br>
        </div>
        <input type="submit" value="Update Page" class="btn btn-outline-primary">
      </form>
    </div>

    <div data-lift="DivSelector.select">
      <div id="num_0">This is div 0</div>
      <div id="num_1">This is div 1</div>
      <div id="num_2">This is div 2</div>
      <div id="num_3">This is div 3</div>
      <div id="num_4">This is div 4</div>
      <div id="num_5">This is div 5</div>
    </div>
    <br>

    <span class="badge badge-secondary">The
      <i>Lift</i> Scala code</span>
    <pre><code class="scala">class DivSelector extends StatefulSnippet {

  private val whichDivs: Array[Boolean] =
    Array(true, true, true, true, true, true)

  def dispatch: DispatchIt = {
    case "select"   => selectDivs
    case "populate" => populate
  }

  def populate: CssSel = "#line" #> whichDivs.toList.zipWithIndex.flatMap {
    case (value, num) =>
      List(
        "#number" #> Text(num.toString) &
          "#checkbox" #> checkbox(value, v => whichDivs(num) = v))
  }

  def selectDivs(in: NodeSeq): NodeSeq = {
    def calcNum(in: String): Box[Int] =
      if (in.startsWith("num_")) asInt(in.substring(4))
      else Empty

    for {
      div <- in \\ "div" // select the div tags
      id = (div \ "@id").text // get their id
      num <- calcNum(id) if whichDivs(num) // filter
    } yield div
  }
}</code></pre>

  </div>
</body>

</html>