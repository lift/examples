<!DOCTYPE html>
<html>

<head>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type" />
  <title>Template</title>
</head>

<body data-lift-content-id="main">
  <div id="main" data-lift="surround?with=default2;at=content">
    <h2><span data-lift="Menu.title">%*%</span></h2>
    <nav aria-label="breadcrumb" role="navigation">
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="index.html">Home</a>
        </li>
        <li class="breadcrumb-item">
          <a href="interactive.html">Interactive Stuff</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page"><span data-lift="Menu.title">%*%</span></li>
      </ol>
    </nav>

    <div id="stateForm">Choose city and state:</div>

    <div id="wrappedNoticeAtHead">
      <div data-lift="Msgs"></div>
    </div>

    <div data-lift="AjaxForm?form=post">
      <div class="form-group form-row">
        <label for="state" class="col-form-label">State:</label>
        <div class="col">
          <select id="state"></select>
        </div>
        <label for="city" class="col-form-label">City:</label>
        <div class="col">
          <select id="city"></select>
        </div>
        <div class="col">
          <input type="submit" />
        </div>
      </div>
    </div>

    <span class="badge badge-secondary">The
      <i>Lift</i> Scala code</span>
    <pre><code class="scala">class AjaxForm {
  var state = AjaxForm.state
  var city = ""

  private def cityChoice(state: String): Elem = {
    val cities = AjaxForm.citiesFor(state)
    val first = cities.head
    // make the select "untrusted" because we might put new values
    // in the select
    untrustedSelect(cities.map(s => (s, s)),
                    Full(first),
                    s => city = s,
                    "class" -> "form-control")
  }

  private def replace(state: String): JsCmd = {
    val cities = AjaxForm.citiesFor(state)
    val first = cities.head
    ReplaceOptions("city", cities.map(s => (s, s)), Full(first))
  }

  def render = {
    "#state" #> ajaxSelect(AjaxForm.states.map(s => (s, s)), Full(state), { s =>
      state = s; After(200, replace(state))
    }, "class" -> "form-control") &
      "#city" #> cityChoice(state) &
      "type=submit" #> submit(?("Save"), () => {
        S.notice("City: " + city + ", State: " + state); redirectTo("/")
      }, "class" -> "btn btn-primary")
  }
}

object AjaxForm {
  val citiesAndStates = List(
    "Alabama" -> "Birmingham",
    "Alabama" -> "Huntsville",
          :
          :
    "Wisconsin" -> "Milwaukee"
  )

  val states = citiesAndStates.map(_._1).distinct

  val state: String = states.head

  def citiesFor(state: String): List[String] =
    citiesAndStates.filter(_._1 == state).map(_._2)
}</code></pre>

  </div>
</body>

</html>